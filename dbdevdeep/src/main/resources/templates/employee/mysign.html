<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{include/mypage_layout}">
<th:block layout:fragment="content">
	<style>
#eye_icon_login {
	display: flex;
	position: absolute;
	z-index: 999;
	left: 320px;
	bottom: 27px;
	cursor: pointer;
}

.hidden {
	display: none;
}

.show {
	display: block;
}
</style>

	<style>
.clicked_sign {
	background-color: rgba(150, 150, 150, 0.1);
	padding: 10px 20px;
	width: 100px;
	height: 100px;
	border-radius: 10px;
}

.form-group:hover {
	background-color: rgba(0, 0, 0, 0.1);
}

.none_clicked_sign {
	padding: 10px 20px;
	width: 100px;
	height: 100px;
	border-radius: 10px;
}

.add_sign {
	background-color: rgba(150, 150, 150, 0.1);
	padding: 10px 20px;
	width: 100px;
	height: 100px;
	border-radius: 10px;
	text-align: center;
	line-height: 80px;
	font-weight: bolder;
}
</style>
	<!-- ============================================================== -->
	<!-- End Left Sidebar - style you can find in sidebar.scss  -->
	<!-- ============================================================== -->
	<!-- ============================================================== -->
	<!-- Page wrapper  -->
	<!-- ============================================================== -->
	<div class="page-wrapper">
		<!-- Container fluid  -->
		<!-- ============================================================== -->
		<div class="container-fluid">
			<!-- ============================================================== -->
			<!-- Start Page Content -->
			<!-- ============================================================== -->
			<div class="row">
				<div class="col-12">
					<div class="card" style="padding: 40px;">
						<div class="card-body show" id="pwcheck">
							<h4 class="card-title">비밀번호 확인</h4>
							<input type="hidden" id="csrf_token" th:value="${_csrf.token}">
							<form id="pwcheckFrm">
								<div class="form-body">
									<div class="row">
										<div class="col-md-3">
											<div class="form-group">
												<input type="password" class="form-control" name="emp_pw" id="pwd" placeholder="비밀번호를 입력하세요."> 
												<i class="fa fa-eye-slash text-left" id="eye_icon_login"></i>
											</div>
										</div>
									</div>
									<button>확인</button>
								</div>
							</form>
						</div>

						<div class="card-body hidden" id="signDiv">
							<h4 class="card-title">내 서명</h4>
								<div class="form-body" style="margin-bottom: 40px;">
									<div class="row">
										<th:block th:each="sign : ${resultList}">
											<div class="col-md-2">
												<div class="form-group clicked_sign">
													<div>
														<img src="">
													</div>
													<label>Label</label>
												</div>
											</div>
										</th:block>
										<th:block th:each="i : ${#numbers.sequence(1, 3 - (#lists.isEmpty(resultList) ? 0 : #lists.size(resultList)))}">
											<div class="col-md-2">
												<div class="form-group add_sign" data-target="#addSign" data-toggle="modal">+</div>
											</div>
										</th:block>
									</div>
								</div>
								<div class="hidden">
									<table class="table">
										<colgroup>
											<col style="width: 20%;">
											<col style="width: 80%;">
										</colgroup>
										<tr>
											<td>서명 제목</td>
											<td>a</td>
										</tr>
										<tr>
											<td>서명 종류</td>
											<td>a</td>
										</tr>
										<tr>
											<td>서명 등록일</td>
											<td>a</td>
										</tr>
										<tr>
											<td>서명 수정일</td>
											<td>a</td>
										</tr>
										<tr>
											<td>대표 서명</td>
											<td>a</td>
										</tr>
									</table>
								</div>
								<div id="addSign" class="modal fade" aria-hidden="true" style="position: static;">
									a
								</div>
								<div class="form-actions">
									<div class="text-right">
										<button type="submit" class="btn btn-info">Submit</button>
										<button type="reset" class="btn btn-dark">Reset</button>
									</div>
								</div>
						</div>
					</div>
				</div>
			</div>

			<!-- ============================================================== -->
			<!-- End PAge Content -->
			<!-- ============================================================== -->
			<!-- ============================================================== -->
			<!-- Right sidebar -->
			<!-- ============================================================== -->
			<!-- .right-sidebar -->
			<!-- ============================================================== -->
			<!-- End Right sidebar -->
			<!-- ============================================================== -->
		</div>
		<!-- ============================================================== -->
		<!-- End Container fluid  -->
		<!-- ============================================================== -->
		<!-- ============================================================== -->
		<!-- footer -->
		<!-- ============================================================== -->
		<footer class="footer text-center text-muted">
			All Rights Reserved by Adminmart. Designed and Developed by <a href="https://wrappixel.com">WrapPixel</a>.
		</footer>
		<!-- ============================================================== -->
		<!-- End footer -->
		<!-- ============================================================== -->
	</div>
	<!-- ============================================================== -->
	<!-- End Page wrapper  -->
	<!-- ============================================================== -->
	<!-- ============================================================== -->
	<!-- End Wrapper -->
	<!-- ============================================================== -->
	<!-- End Wrapper -->
	<!-- ============================================================== -->
	<!-- All Jquery -->
	<!-- ============================================================== -->
	<script src="/assets/libs/jquery/dist/jquery.min.js"></script>
	<!-- Bootstrap tether Core JavaScript -->
	<script src="/assets/libs/popper.js/dist/umd/popper.min.js"></script>
	<script src="/assets/libs/bootstrap/dist/js/bootstrap.min.js"></script>
	<!-- apps -->
	<!-- apps -->
	<script src="/dist/js/app-style-switcher.js"></script>
	<script src="/dist/js/feather.min.js"></script>
	<!-- slimscrollbar scrollbar JavaScript -->
	<script src="/assets/libs/perfect-scrollbar/dist/perfect-scrollbar.jquery.min.js"></script>
	<script src="/assets/extra-libs/sparkline/sparkline.js"></script>
	<!--Wave Effects -->
	<!-- themejs -->
	<!--Menu sidebar -->
	<script src="/dist/js/sidebarmenu.js"></script>
	<!--Custom JavaScript -->
	<script src="/dist/js/custom.min.js"></script>
	<!--This page plugins -->
	<script src="/assets/extra-libs/datatables.net/js/jquery.dataTables.min.js"></script>
	<script src="/dist/js/pages/datatable/datatable-basic.init.js"></script>
	<script th:src="@{/login.js}"></script>

	<script>
	
		document.getElementById('pwcheckFrm').addEventListener('submit', (e) => {
			const pw = document.getElementById('pwd');
			e.preventDefault();
			
			let vali_check = false;
			let vali_text = "";
			
			if(pw.value.length == 0) {
				vali_text = "비밀번호를 입력하세요";
			} else {
				vali_check = true;
			}
			
			if(vali_check) {
				const csrfToken = document.getElementById("csrf_token").value;
				
				fetch('/check-pw/' + pw.value, {
					method: 'GET',
					headers : {
						'Accept': 'application/json',
			            'Content-Type': 'application/json',
						'X-CSRF-TOKEN': csrfToken
					},
				})
				.then(response => response.json())
				.then(data=>{
					if(data.res_code == '200'){
						Swal.fire({
							icon :'success',
							title:'성공',
							text : data.res_msg,
							confirmButtonText:"닫기"
						})
						.then(() => {
							document.getElementById('pwcheck').classList.add('hidden');
							document.getElementById('pwcheck').classList.remove('show');
							document.getElementById('signDiv').classList.add('show');
							document.getElementById('signDiv').classList.remove('hidden');
							
							
						});
						
					} else{
						Swal.fire({
							icon:'error',
							title:'실패',
							text: data.res_msg,
							confirmButtonText:"닫기"
						});
					}
				});
			} else {
				Swal.fire({
					icon: 'error',
					title: '실패',
					text: vali_text,
					confirmButtonText:"닫기"
				})
			}
		});
		
	
	</script>
</th:block>
</html>